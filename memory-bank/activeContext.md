# ç•¶å‰å·¥ä½œé‡é»

## å·¥å…·éˆé‡æ§‹å®Œæˆ âœ…

### å·²å®Œæˆçš„å·¥å…·éˆé‡æ§‹ä»»å‹™

1. **ç›®éŒ„çµæ§‹é‡çµ„å®Œæˆ (ç¬¬ä¸€éšæ®µ)**
   - âœ… `apps/container` â†’ `apps/api-server`
   - âœ… æ¸¬è©¦æª”æ¡ˆå¾ `apps/api-server/tests/` ç§»è‡³ `packages/core-logic/tests/`
   - âœ… CLI pyproject.toml å¾ `apps/api-server/` ç§»è‡³ `apps/cli/`
   - âœ… æ¸…ç†äº† `apps/api-server/src/` ä¸­çš„èˆŠæª”æ¡ˆ

2. **é…ç½®æª”æ¡ˆæ›´æ–°å®Œæˆ (ç¬¬ä¸€éšæ®µ)**
   - âœ… æ›´æ–° Makefile ä¸­æ‰€æœ‰å° `apps/container` çš„å¼•ç”¨ç‚º `apps/api-server`
   - âœ… æ›´æ–°æ¸¬è©¦è·¯å¾‘å¾ `apps/container/tests/` åˆ° `packages/core-logic/tests/`
   - âœ… æ›´æ–° docker-compose.yml é©æ‡‰æ–°æ¶æ§‹
   - âœ… ä¿®å¾© Dockerfile.api è·¯å¾‘å•é¡Œ
   - âœ… ä¿®å¾© `apps/api-server/requirements.txt` ä¸­ç›¸å°è·¯å¾‘

3. **å‰ç«¯å·¥å…·éˆé‡æ§‹å®Œæˆ (ç¬¬äºŒéšæ®µ)**
   - âœ… å‚™ä»½ root å±¤ç´šé…ç½®æª”æ¡ˆ (.bk)
   - âœ… å‰ç«¯é…ç½®é·ç§»åˆ° `apps/web/`
     âœ… `wrangler.frontend.toml` â†’ `apps/web/wrangler.toml`
     - å‰µå»º `apps/web/turbo.json` 
     âœ… æ›´æ–° `apps/web/package.json` æ·»åŠ éƒ¨ç½²è…³æœ¬
   - âœ… Makefile å¢å¼·æ”¯æ´å‰ç«¯ç®¡ç†
     âœ… æ·»åŠ  `dev-frontend`, `build-frontend`, `deploy-frontend` ç­‰æŒ‡ä»¤
     âœ… çµ±ä¸€çš„é–‹ç™¼é«”é©— (`dev-all`, `build-all`, `install-all`)
   - âœ… åŠŸèƒ½é©—è­‰æ¸¬è©¦é€šé
     âœ… å‰ç«¯ä¾è³´å®‰è£æˆåŠŸ
     âœ… Next.js å»ºç½®æˆåŠŸ  
     âœ… é–‹ç™¼æœå‹™å™¨å•Ÿå‹•æ­£å¸¸

4. **Docker æ§‹å»ºæ¸¬è©¦å®Œæˆ**
   - âœ… API Docker æ˜ åƒæ§‹å»ºæˆåŠŸ
   - âœ… CLI Docker æ˜ åƒä¹‹å‰å·²é©—è­‰å¯æ­£å¸¸é‹ä½œ

### ç•¶å‰å°ˆæ¡ˆæ¶æ§‹ (é‡æ§‹å¾Œ)

```
coaching_transcript_tool/
â”œâ”€â”€ apps/                    # æ‡‰ç”¨ç¨‹å¼å±¤
â”‚   â”œâ”€â”€ api-server/         # FastAPI æœå‹™å™¨ (é‡æ§‹å‰: backend/)
â”‚   â”‚   â”œâ”€â”€ main.py         # FastAPI æ‡‰ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ requirements.txt # API æœå‹™ä¾è³´
â”‚   â”‚   â””â”€â”€ Dockerfile.api  # API Docker æª”æ¡ˆ
â”‚   â”œâ”€â”€ cli/                # å‘½ä»¤åˆ—å·¥å…· (é‡æ§‹å‰: backend/)
â”‚   â”‚   â”œâ”€â”€ main.py         # CLI å…¥å£é»
â”‚   â”‚   â”œâ”€â”€ requirements.txt # CLI ä¾è³´
â”‚   â”‚   â”œâ”€â”€ pyproject.toml  # CLI å¥—ä»¶é…ç½®
â”‚   â”‚   â””â”€â”€ Dockerfile      # CLI Docker æª”æ¡ˆ
â”‚   â”œâ”€â”€ cloudflare/         # Cloudflare Workers é–˜é“ (é‡æ§‹å‰: gateway/)
â”‚   â”‚   â”œâ”€â”€ main.py         # Workers å…¥å£é»
â”‚   â”‚   â”œâ”€â”€ requirements.txt # Workers ä¾è³´
â”‚   â”‚   â”œâ”€â”€ wrangler.toml   # Cloudflare é…ç½®
â”‚   â”‚   â””â”€â”€ src/            # Workers æºç¢¼
â”‚   â””â”€â”€ web/                # Next.js å‰ç«¯ (é‡æ§‹å‰: frontend/)
â”‚       â”œâ”€â”€ app/
â”‚       â”œâ”€â”€ components/
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ packages/               # å…±äº«å¥—ä»¶å±¤
â”‚   â”œâ”€â”€ core-logic/         # æ ¸å¿ƒæ¥­å‹™é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ src/coaching_assistant/ # æ ¸å¿ƒæ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ tests/          # æ¸¬è©¦æª”æ¡ˆ (å¾ apps/api-server ç§»éä¾†)
â”‚   â”‚   â””â”€â”€ pyproject.toml  # æ ¸å¿ƒå¥—ä»¶é…ç½®
â”‚   â””â”€â”€ shared-types/       # å…±äº«é¡å‹å®šç¾© (é ç•™)
â”œâ”€â”€ docs/                   # æ­£å¼å°ˆæ¡ˆæ–‡æª”
â””â”€â”€ memory-bank/            # Cline AI å·¥ä½œè¨˜æ†¶
```

### é©—è­‰çµæœ

- âœ… API Docker æ˜ åƒæ§‹å»ºæˆåŠŸ (31.8s)
- âœ… CLI Docker æ˜ åƒä¹‹å‰æ¸¬è©¦æ­£å¸¸
- âœ… æ‰€æœ‰è·¯å¾‘å¼•ç”¨å·²æ›´æ–°
- âœ… æ¸¬è©¦é…ç½®å·²èª¿æ•´

## ä¸‹ä¸€éšæ®µè¦åŠƒ

### çŸ­æœŸç›®æ¨™
1. æ¸¬è©¦æ–°æ¶æ§‹ä¸‹çš„å®Œæ•´åŠŸèƒ½
2. é©—è­‰ docker-compose æ•´é«”æœå‹™å•Ÿå‹•
3. ç¢ºèªæ‰€æœ‰ make æŒ‡ä»¤æ­£å¸¸é‹ä½œ

### ä¸­æœŸç›®æ¨™  
1. å¯¦ä½œå‰ç«¯èˆ‡æ–° API æ¶æ§‹çš„æ•´åˆ
2. å®Œå–„ `packages/shared-types` çš„å‹åˆ¥å®šç¾©
3. å„ªåŒ– Docker æ§‹å»ºæ•ˆç‡

### æŠ€è¡“å‚µå‹™
- è€ƒæ…®ä½¿ç”¨ multi-stage build å„ªåŒ– Docker æ˜ åƒå¤§å°
- è©•ä¼°æ˜¯å¦éœ€è¦çµ±ä¸€ Python ä¾è³´ç®¡ç† (poetry/pipenv)
- è¦åŠƒ CI/CD pipeline é©æ‡‰æ–°æ¶æ§‹

## ç•¶å‰å·¥ä½œé‡é» - Coach Assistant MVP å¯¦ä½œ ğŸš€

**è³‡æ–™åº«æ¨¡å‹èˆ‡èªè­‰åŸºç¤å®Œæˆï¼** âœ…  
**Render PostgreSQL ç”Ÿç”¢è³‡æ–™åº«éƒ¨ç½²å®Œæˆï¼** âœ…  
**åŸºæ–¼ Render + PostgreSQL + GCS çš„æ¶æ§‹** ğŸ”„

### ğŸ¯ æœ€æ–°å®Œæˆé …ç›® (2025-08-05 æ›´æ–°)

#### âœ… Phase 1B é€²å±•ï¼šRender è³‡æ–™åº«éƒ¨ç½²å®Œæˆ
- **PostgreSQL è³‡æ–™åº«å»ºç«‹å®Œæˆ**
  - è³‡æ–™åº«å¯¦ä¾‹ï¼šdpg-d27igr7diees73cla8og-a (Singapore)
  - é€£ç·šè¨­å®šæ–‡æª”ï¼šdocs/deployment/render-deployment.md
  - å®‰å…¨å¯†é‘°å·²ç”Ÿæˆä¸¦è¨˜éŒ„

- **Alembic è³‡æ–™åº«é·ç§»ç³»çµ±**
  - Alembic åˆå§‹åŒ–å®Œæˆ (packages/core-logic/alembic/)
  - ç’°å¢ƒè®Šæ•¸æ”¯æ´è¨­å®šå®Œæˆ
  - åˆå§‹é·ç§»è…³æœ¬æˆåŠŸåŸ·è¡Œ
  - æ‰€æœ‰è³‡æ–™è¡¨å·²åœ¨ç”Ÿç”¢ç’°å¢ƒå»ºç«‹

#### âœ… Phase 1Aï¼šè³‡æ–™æ¨¡å‹èˆ‡æ¸¬è©¦åŸºç¤ (å·²å®Œæˆ)
- **æ ¸å¿ƒè³‡æ–™æ¨¡å‹å¯¦ä½œ**
  - Userã€Sessionã€TranscriptSegmentã€SessionRole å®Œæ•´å¯¦ä½œ
  - SQLAlchemy ORM æ¨¡å‹èˆ‡é—œè¯é—œä¿‚
  - UUID ä¸»éµå’Œæ™‚é–“æˆ³åŸºç¤æ¨¡å¼
  - Enum é¡å‹ï¼šUserPlanã€SessionStatusã€SpeakerRole

- **å®Œæ•´å–®å…ƒæ¸¬è©¦è¦†è“‹ (82 å€‹æ¸¬è©¦ï¼Œ100% é€šé)**
  - æ¨¡å‹åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
  - å¤–éµç´„æŸå’Œå”¯ä¸€æ€§ç´„æŸæ¸¬è©¦
  - å±¬æ€§æ–¹æ³•å’Œæ¥­å‹™é‚è¼¯æ¸¬è©¦
  - é—œè¯é—œä¿‚å’Œç´šè¯åˆªé™¤æ¸¬è©¦
  - SQLite å¤–éµç´„æŸæ­£ç¢ºå•Ÿç”¨

- **é–‹ç™¼ç’°å¢ƒå®Œå–„**
  - Docker é–‹ç™¼é…ç½® (Dockerfile.dev, docker-compose.dev.yml)
  - ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹ (.env.example)
  - æ¸¬è©¦é…ç½®å„ªåŒ– (conftest.py)

### ğŸ“‹ å¯¦ä½œè¨ˆåŠƒæ›´æ–° (6é€± MVP)

#### Phase 1B (ç•¶å‰å„ªå…ˆ)ï¼šGoogle Cloud èˆ‡ Render éƒ¨ç½²
- ğŸ¯ **å»ºç«‹ Render å°ˆæ¡ˆ**ï¼šWeb Service + PostgreSQL è³‡æ–™åº«
- ğŸ¯ **Google Cloud è¨­å®š**ï¼šå°ˆæ¡ˆå»ºç«‹ã€API å•Ÿç”¨ã€æœå‹™å¸³è™Ÿ
- ğŸ¯ **è³‡æ–™åº«é·ç§»**ï¼šSQLite â†’ PostgreSQLï¼ŒAlembic é·ç§»è…³æœ¬
- ğŸ¯ **éƒ¨ç½²é©—è­‰**ï¼šRender ç’°å¢ƒæ¸¬è©¦ï¼Œè³‡æ–™åº«é€£ç·šç¢ºèª

#### Phase 2 (ç¬¬3-4é€±)ï¼šèªè­‰èˆ‡æª”æ¡ˆè™•ç†
- ğŸ”„ Google OAuth 2.0 èªè­‰æµç¨‹
- ğŸ”„ JWT token ç®¡ç†èˆ‡ refresh æ©Ÿåˆ¶
- ğŸ”„ Google Cloud Storage æª”æ¡ˆä¸Šå‚³
- ğŸ”„ æª”æ¡ˆå¤§å°å’Œæ ¼å¼é©—è­‰

#### Phase 3 (ç¬¬4-5é€±)ï¼šè½‰éŒ„æ ¸å¿ƒåŠŸèƒ½
- ğŸ”„ Google Speech-to-Text API æ•´åˆ
- ğŸ”„ Background job è™•ç† (Celery + Redis)
- ğŸ”„ Speaker diarization çµæœè™•ç†
- ğŸ”„ WebSocket é€²åº¦æ¨æ’­

#### Phase 4 (ç¬¬5-6é€±)ï¼šå®Œå–„èˆ‡å„ªåŒ–
- ğŸ”„ è½‰éŒ„çµæœåŒ¯å‡º (VTT, SRT, JSON)
- ğŸ”„ ä½¿ç”¨é‡è¿½è¹¤å’Œè¨ˆåŠƒé™åˆ¶
- ğŸ”„ å‰ç«¯ UI æ•´åˆèˆ‡æ¸¬è©¦

### ğŸ¯ ç•¶å‰æœ€é«˜å„ªå…ˆä»»å‹™

1. **å®Œæˆ Render Web Service éƒ¨ç½²** (ä»Šæ—¥ç›®æ¨™)
   - âœ… PostgreSQL è³‡æ–™åº«å·²å»ºç«‹ä¸¦é…ç½®
   - ğŸ¯ åœ¨ Render Dashboard å»ºç«‹ Web Service
   - ğŸ¯ è¨­å®šæ‰€æœ‰å¿…è¦ç’°å¢ƒè®Šæ•¸
   - ğŸ¯ é©—è­‰ API ç«¯é»æ­£å¸¸é‹ä½œ

2. **Google Cloud ç’°å¢ƒè¨­å®š** (æœ¬é€±)
   - ğŸ¯ å»ºç«‹æ–°çš„ GCP å°ˆæ¡ˆ
   - ğŸ¯ å•Ÿç”¨ Cloud Storage å’Œ Speech-to-Text API
   - ğŸ¯ å»ºç«‹æœå‹™å¸³è™Ÿä¸¦ä¸‹è¼‰ JSON é‡‘é‘°
   - ğŸ¯ å»ºç«‹ Storage bucket (å‘½åï¼šcoaching-audio-prod)

3. **Google OAuth è¨­å®š** (æœ¬é€±)
   - ğŸ¯ åœ¨ Google Cloud Console è¨­å®š OAuth 2.0
   - ğŸ¯ è¨­å®šæˆæ¬Šé‡å®šå‘ URI
   - ğŸ¯ å–å¾— Client ID å’Œ Client Secret
   - ğŸ¯ æ›´æ–° Render ç’°å¢ƒè®Šæ•¸

### ğŸ—ï¸ æ¶æ§‹ç¾ç‹€

#### âœ… å·²é©—è­‰çµ„ä»¶
- **Monorepo çµæ§‹**ï¼šapps/ + packages/ æ¶æ§‹ç©©å®š
- **è³‡æ–™æ¨¡å‹**ï¼šSQLAlchemy æ¨¡å‹å®Œæ•´ä¸”æ¸¬è©¦é€šé
- **å‰ç«¯éƒ¨ç½²**ï¼šCloudflare Workers é‹è¡Œæ­£å¸¸
- **é–‹ç™¼ç’°å¢ƒ**ï¼šDocker å®¹å™¨åŒ–é–‹ç™¼æµç¨‹

#### ğŸ”„ æ•´åˆä¸­çµ„ä»¶
- **å¾Œç«¯éƒ¨ç½²**ï¼šå¾æœ¬åœ°é–‹ç™¼ â†’ Render ç”Ÿç”¢ç’°å¢ƒ
- **è³‡æ–™åº«**ï¼šå¾ SQLite é–‹ç™¼ â†’ PostgreSQL ç”Ÿç”¢
- **èªè­‰ç³»çµ±**ï¼šGoogle OAuth æ•´åˆ

#### ğŸ“ å¾…å¯¦ä½œçµ„ä»¶
- **æª”æ¡ˆè™•ç†**ï¼šGoogle Cloud Storage æ•´åˆ
- **è½‰éŒ„æœå‹™**ï¼šGoogle Speech-to-Text API
- **èƒŒæ™¯ä»»å‹™**ï¼šCelery å·¥ä½œä½‡åˆ—

### ğŸ’° æˆæœ¬çµæ§‹ (ç¢ºèª)
- **å›ºå®šæˆæœ¬**ï¼š$15/æœˆ (Render Web + PostgreSQL + GCS)
- **è®Šå‹•æˆæœ¬**ï¼š$0.016/åˆ†é˜ (Google Speech-to-Text)
- **ç›®æ¨™æ¯›åˆ©**ï¼š70-78% (Pro plan $599/æœˆ)

### ğŸ”§ æŠ€è¡“æ±ºç­–è¨˜éŒ„

#### è³‡æ–™åº«è¨­è¨ˆæ±ºç­–
- **UUID ä¸»éµ**ï¼šåˆ†æ•£å¼ç³»çµ±å‹å–„ï¼Œé¿å… ID è¡çª
- **æ™‚é–“æˆ³è¿½è¹¤**ï¼šcreated_at, updated_at è‡ªå‹•ç®¡ç†
- **å¤–éµç´„æŸ**ï¼šç¢ºä¿è³‡æ–™å®Œæ•´æ€§
- **è»Ÿåˆªé™¤**ï¼šè€ƒæ…®æœªä¾†éœ€æ±‚ï¼Œç›®å‰ä½¿ç”¨ç¡¬åˆªé™¤ç°¡åŒ–é‚è¼¯

#### æ¸¬è©¦ç­–ç•¥æ±ºç­–
- **å–®å…ƒæ¸¬è©¦å„ªå…ˆ**ï¼šæ¨¡å‹å±¤ 100% è¦†è“‹
- **SQLite æ¸¬è©¦**ï¼šå¿«é€Ÿã€éš”é›¢çš„æ¸¬è©¦ç’°å¢ƒ
- **å¤–éµç´„æŸå•Ÿç”¨**ï¼šç¢ºä¿æ¸¬è©¦ç’°å¢ƒèˆ‡ç”Ÿç”¢ç’°å¢ƒä¸€è‡´æ€§
